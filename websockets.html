<html lang="en">

<head>
	<title>websockets test</title>
</head>

<body>
	<form name="publish">
		<input type="text" name="message">
		<input type="submit" value="Отправить">
	</form>
	<!-- здесь будут появляться входящие сообщения -->
	<div id="subscribe"></div>

	<script type="text/javascript">

		var config = {
			wsUrl: 'ws://localhost:5000',
			//wsUrl: 'ws://pg-api.azurewebsites.net/api',
		};

		var mockMessage = JSON.stringify({ authToken: '4d824e03-e485-4763-9e52-3fff98346a55'});

		var socket = new WebSocket(config.wsUrl);

		// отправить сообщение из формы publish
		document.forms.publish.onsubmit = function () {
			var outgoingMessage = this.message.value;

			//socket.send(outgoingMessage);
			socket.send(mockMessage);
			return false;
		};

		// обработчик входящих сообщений
		socket.onmessage = function (event) {
			console.log(event);
			var incomingMessage = event.data;
			showMessage(incomingMessage);
		};

		// показать сообщение в div#subscribe
		function showMessage(message) {
			console.log(message);
			var messageElem = document.createElement('div');
			messageElem.appendChild(document.createTextNode(message));
			document.getElementById('subscribe').appendChild(messageElem);
		}
	</script>
</body>

</html>